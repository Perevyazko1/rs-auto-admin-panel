"use strict";(self.webpackChunkfront_rs_auto_admin=self.webpackChunkfront_rs_auto_admin||[]).push([[807],{8807:(e,t,a)=>{a.r(t),a.d(t,{default:()=>j});var r=a(5043),s=a(7830),o=a(8977),n=a(5376),i=a(547),c=a(8446),u=a(6446),l=a(5865),d=a(9252),h=a(8279),p=a(5969),m=a(4620),g=a(1306),f=a(3637),x=a(3216),A=a(7154),w=a(4451),y=a(579);function v(e){return(0,y.jsxs)(l.A,{variant:"body2",color:"text.secondary",align:"center",...e,children:["Copyright \xa9 ",(0,y.jsx)(c.A,{color:"inherit",href:"https://mui.com/",children:"Your Website"})," ",(new Date).getFullYear(),"."]})}const b=(0,h.A)();const j=function(){const e=(0,x.Zp)(),t=(0,g.D)(),{authApp:a}=f.m.actions,[c,h]=(0,r.useState)(""),[j,k]=(0,r.useState)(""),[S,{data:C,isLoading:_,error:I}]=m.d.useAuthMutation();return(0,y.jsx)(p.A,{theme:b,children:(0,y.jsxs)(d.A,{component:"main",maxWidth:"xs",children:[(0,y.jsx)(n.Ay,{}),(0,y.jsxs)(u.A,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,y.jsx)(s.A,{sx:{m:1,bgcolor:"secondary.main"}}),(0,y.jsx)(l.A,{component:"h1",variant:"h5",children:"\u0412\u0445\u043e\u0434"}),(0,y.jsx)(i.A,{value:c,onChange:e=>h(e.target.value),margin:"normal",required:!0,fullWidth:!0,id:"username",label:"\u041b\u043e\u0433\u0438\u043d",name:"username",autoComplete:"username",autoFocus:!0}),(0,y.jsx)(i.A,{value:j,onChange:e=>k(e.target.value),margin:"normal",required:!0,fullWidth:!0,name:"password",label:"\u041f\u0430\u0440\u043e\u043b\u044c",type:"password",id:"password",autoComplete:"current-password"}),(0,y.jsx)(o.A,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},onClick:async()=>{try{var r;const n={username:c,password:j},i=await A.A.post("".concat(w.H,"organization_app/api/token/"),n);var s,o;if(i.data)localStorage.setItem("token",null===(s=i.data)||void 0===s?void 0:s.access),sessionStorage.setItem("refresh",null===(o=i.data)||void 0===o?void 0:o.refresh);null!==(r=i.data)&&void 0!==r&&r.access&&(localStorage.setItem("organization",c),t(a({auth:!0,user:c})),e("/"))}catch(I){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430:",I)}},children:"\u0412\u043e\u0439\u0442\u0438"})]}),(0,y.jsx)(v,{sx:{mt:8,mb:4}})]})})}},4451:(e,t,a)=>{a.d(t,{A:()=>c,H:()=>n});var r=a(7068),s=a(5043),o=a(7154);r.Simulate.error;const n="https://rs-auto.tw1.ru/",i=o.A.create({baseURL:n});i.interceptors.request.use((e=>(e.headers.Authorization="Bearer ".concat(localStorage.getItem("token")),e))),i.interceptors.response.use((e=>e),(async e=>{if(401===e.response.status&&e.config&&!e.config._retry){e.config._retry=!0;try{const t={refresh:sessionStorage.getItem("refresh")},a=await o.A.post("".concat(n,"organization_app/api/token/refresh/"),t);return localStorage.setItem("token",a.data.access),i.request(e.config)}catch(t){console.log(t,"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d")}}return Promise.reject(e)}));const c=()=>{const[e,t]=(0,s.useState)(null),[a,r]=(0,s.useState)(null),[o,n]=(0,s.useState)(!1);return{data:e,error:a,loading:o,executeRequest:async(e,s,o)=>{const c={"Content-Type":"application/json"};n(!0);try{let a;switch(e.toUpperCase()){case"GET":a=await i.get(s,{headers:c});break;case"POST":a=await i.post(s,o,{headers:c});break;case"PUT":a=await i.put(s,o,{headers:c});break;default:throw new Error("Unsupported method")}t(a.data),n(!1)}catch(a){r(a),n(!1)}}}}}}]);
//# sourceMappingURL=807.85240a05.chunk.js.map